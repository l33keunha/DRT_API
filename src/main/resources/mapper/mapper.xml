<?xml version="1.0" encoding="EUC-KR"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ybs.api.boot.service.impl.ApiMapper">

    <select id="getSttn" parameterType="Map" resultType="Map">
        SELECT *
        FROM
            DRP_STTN
        WHERE 1=1
          AND RUN_AREA_CD= #{RUN_AREA_CD}
          ORDER BY NODE_ID 
    </select>

    <select id="getSche"  parameterType="Map" resultType="Map">
        SELECT
            SDATE
             ,ST_TM
             ,AREA_NM
             ,AREA_CD
             ,RUN_AREA_NM
             ,RUN_AREA_CD
             ,RUN_ORDER
             ,ROUTE_ID
             ,ROUTE_NM
             ,ROUTE_NMA
             ,ROUTE_DIR
             ,PLAT_NUM
             ,DRIVER_NM
             ,F_NODE_NM
             ,T_NODE_NM
             ,F_NODE_ID
             ,T_NODE_ID
             ,MAX_TT
             ,MAX_USER
        FROM
            DRP_ROUTE_SCHE
        WHERE 1=1
          AND SDATE = TO_DATE(#{SDATE}, 'YYYYMMDD')
          AND ST_TM LIKE #{ST_TM}||'%'
          AND ROUTE_ID =  #{ROUTE_ID}
    </select>

    <insert id="setUserMast" parameterType="map">
        INSERT INTO DRP_USER_MAST VALUES
            (
                TO_DATE(#{REV_DATE}, 'YYYYMMDD'),
                #{REV_TM},
                TO_DATE(#{SDATE}, 'YYYYMMDD'),
                #{ST_TM},
                #{AREA_NM},
                #{AREA_CD},
                #{RUN_AREA_NM},
                #{RUN_AREA_CD},
                #{RUN_ORDER},
                #{ROUTE_ID},
                #{ROUTE_NM},
                #{ROUTE_NMA},
                #{ROUTE_DIR},
                #{PLAT_NUM},
                #{STTN_IN_NM},
                #{STTN_OUT_NM},
                #{STTN_IN_ID},
                #{STTN_OUT_ID},
                #{MAX_SEAT},
                #{TOTAL_DIST},
                #{TOTAL_TM},
                #{USER_CNT},
                #{USER_NM},
                #{USER_PHONE},
                #{REV_TYPE}
            )
    </insert>

    <select id="getUserMast" parameterType="map" resultType="map">
        SELECT *
        FROM DRP_USER_MAST
        WHERE 1=1
          AND ROUTE_ID =  #{ROUTE_ID}
          AND ROUTE_DIR = #{ROUTE_DIR}
          AND SDATE = TO_DATE(#{SDATE}, 'YYYYMMDD')
          AND ST_TM LIKE #{ST_TM}||'%'
    </select>

    <insert id="setHist" parameterType="map">
        INSERT INTO DRP_ROUTE_HIST VALUES
            (
                TO_DATE(#{SDATE}, 'YYYYMMDD'),
                #{ST_TM},
                #{AREA_NM},
                #{AREA_CD},
                #{RUN_AREA_NM},
                #{RUN_AREA_CD},
                #{RUN_ORDER},
                #{ROUTE_ID},
                #{ROUTE_NM},
                #{ROUTE_NMA},
                #{ROUTE_DIR},
                #{PLAT_NUM},
                #{DRIVER_NM},
                #{F_NODE_NM},
                #{T_NODE_NM},
                #{F_NODE_ID},
                #{T_NODE_ID},
                #{TOTAL_DIST},
                #{TOTAL_TM},
                #{USER_CNT},
                #{BOARDING_STATUS}
            )
    </insert>

    <insert id="setPath" parameterType="list">
        INSERT INTO DRP_PATH VALUES
        <foreach collection="list" item="list" separator=" , ">
            (
            NULL, NULL, NULL, NULL,
            #{list.index},
            #{list.name},
            #{list.nodeType},
            #{list.point},
            #{list.lineString},
            #{list.coordinates},
            #{list.turnType},
            #{list.pointIndex},
            #{list.pointType},
            #{list.lineIndex},
            #{list.distance},
            #{list.time},
            #{list.roadType},
            #{list.facilityType},
            #{list.linkId},
            #{list.costdstn}
            )
        </foreach>
    </insert>
</mapper>